import numpy

def linear_solve(A, b):
    """Решает систему линейных уравнений A @ x = b методом наименьших квадратов.
    
    Использует SVD-разложение (не LU) для численной устойчивости.
    Работает для квадратных, переопределённых и недоопределённых систем.
    
    Args:
        A: Матрица коэффициентов размера (m, n)
        b: Вектор правой части размера (m,)
        
    Returns:
        Решение x размера (n,) минимизирующее ||A@x - b||²
    """
    # im = numpy.linalg.pinv(A)
    # res = im.dot(b)
    # return res
    return numpy.linalg.lstsq(A, b, rcond=None)[0]
