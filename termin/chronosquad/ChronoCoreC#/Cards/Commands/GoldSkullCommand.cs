using System.Collections;
using System.Collections.Generic;
using System;

#if UNITY_64
using UnityEngine;
#endif

public class GoldSkullCommand : ThrowToEnvironmentCommand
{
    // public float shoot_distance;
    // public float radius_of_sound = 2;
    // ReferencedPoint _target_position;
    // RestlessnessParameters noise_parameters;

    string skull_name;

    public GoldSkullCommand(ReferencedPoint target_position, float radius, long stamp, string name)
        : base(target_position, radius, stamp)
    {
        skull_name = name;
    }

    override protected void AddEvents(ObjectOfTimeline actor, ITimeline tl)
    {
        var skull = tl.GetObject(skull_name);
        var skull_stamp = skull.LocalStep();

        var position = _target_position.GlobalPosition(tl);
        var animatronic = new ParabolicAnimatronic(
            actor.CurrentReferencedPose(),
            ReferencedPose.FromGlobalPose(
                new Pose(position, Quaternion.identity),
                actor.CurrentReferencedPose().Frame,
                tl
            ),
            skull_stamp,
            skull_stamp + 100,
            maxtime: 1.0f
        );

        skull.SetNextAnimatronic(animatronic);
        var change_lure = new ChangeLureStateEvent(skull_stamp + 101, true);
        skull.AddCard(change_lure);
    }

    public override bool IsTrajectoryClear(
        ObjectOfTimeline actor,
        ITimeline timeline,
        Vector3 target_global
    )
    {
        return GameCore.InLineOfSight(actor, target_global, maxdistance: shoot_distance);
    }

    //BEGIN################################################################
    // This code was generated by FieldScanner

    public override long HashCode()
    {
        long result = 0;
        result = FieldScanner.ModifyHash(result, skull_name);
        result = FieldScanner.ModifyHash(result, shoot_distance);
        result = FieldScanner.ModifyHash(result, noise_parameters);
        result = FieldScanner.ModifyHash(result, can_shoot_from_croach);
        result = FieldScanner.ModifyHash(result, _target_position);
        result = FieldScanner.ModifyHash(result, _target_type);
        result = FieldScanner.ModifyHash(result, _start_type);
        result = FieldScanner.ModifyHash(result, _walking_type);
        result = FieldScanner.ModifyHash(result, _braced_coordinates);
        result = FieldScanner.ModifyHash(result, _look_around);
        result = FieldScanner.ModifyHash(result, start_step);
        result = FieldScanner.ModifyHash(result, finish_step);
        return result;
    }

    public override bool Equals(object obj)
    {
        if (obj == null)
            return false;
        if (obj.GetType() != GetType())
            return false;
        var other = obj as GoldSkullCommand;
        return skull_name == other.skull_name
            && shoot_distance == other.shoot_distance
            && noise_parameters == other.noise_parameters
            && can_shoot_from_croach == other.can_shoot_from_croach
            && _target_position == other._target_position
            && _target_type == other._target_type
            && _start_type == other._start_type
            && _walking_type == other._walking_type
            && _braced_coordinates == other._braced_coordinates
            && _look_around == other._look_around
            && start_step == other.start_step
            && finish_step == other.finish_step
            && true;
    }

    public override int GetHashCode()
    {
        return (int)HashCode();
    }
    //END################################################################
}
