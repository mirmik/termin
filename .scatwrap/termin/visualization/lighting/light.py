<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>termin/visualization/lighting/light.py</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
&quot;&quot;&quot;Примитивы&nbsp;источников&nbsp;света&nbsp;для&nbsp;forward-рендеринга.&quot;&quot;&quot;<br>
<br>
from&nbsp;__future__&nbsp;import&nbsp;annotations<br>
<br>
from&nbsp;dataclasses&nbsp;import&nbsp;dataclass,&nbsp;field<br>
from&nbsp;enum&nbsp;import&nbsp;Enum<br>
from&nbsp;typing&nbsp;import&nbsp;Optional<br>
<br>
import&nbsp;numpy&nbsp;as&nbsp;np<br>
<br>
from&nbsp;.attenuation&nbsp;import&nbsp;AttenuationCoefficients<br>
<br>
<br>
class&nbsp;LightType(str,&nbsp;Enum):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Поддерживаемые&nbsp;типы&nbsp;источников.&quot;&quot;&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;DIRECTIONAL&nbsp;=&nbsp;&quot;directional&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;POINT&nbsp;=&nbsp;&quot;point&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;SPOT&nbsp;=&nbsp;&quot;spot&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;AMBIENT&nbsp;=&nbsp;&quot;ambient&quot;<br>
<br>
<br>
@dataclass<br>
class&nbsp;LightShadowParams:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Настройки&nbsp;теневой&nbsp;карты&nbsp;для&nbsp;источника&nbsp;света.&quot;&quot;&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;enabled:&nbsp;bool&nbsp;=&nbsp;False<br>
&nbsp;&nbsp;&nbsp;&nbsp;bias:&nbsp;float&nbsp;=&nbsp;0.001<br>
&nbsp;&nbsp;&nbsp;&nbsp;normal_bias:&nbsp;float&nbsp;=&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;map_resolution:&nbsp;int&nbsp;=&nbsp;1024<br>
<br>
<br>
@dataclass<br>
class&nbsp;LightSample:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Результат&nbsp;оценки&nbsp;вклада&nbsp;света&nbsp;в&nbsp;точке&nbsp;поверхности.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Выходящая&nbsp;радиансная&nbsp;составляющая:<br>
&nbsp;&nbsp;&nbsp;&nbsp;``L_o&nbsp;=&nbsp;attenuation&nbsp;*&nbsp;intensity_rgb``.&nbsp;Вектор&nbsp;``L``&nbsp;направлен&nbsp;от&nbsp;точки<br>
&nbsp;&nbsp;&nbsp;&nbsp;поверхности&nbsp;к&nbsp;источнику&nbsp;(используется&nbsp;в&nbsp;скалярных&nbsp;произведениях&nbsp;вида<br>
&nbsp;&nbsp;&nbsp;&nbsp;``max(dot(N,&nbsp;L),&nbsp;0)``).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;L:&nbsp;np.ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;distance:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;attenuation:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;radiance:&nbsp;np.ndarray<br>
<br>
<br>
def&nbsp;_normalize(vec:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;np.ndarray:<br>
&nbsp;&nbsp;&nbsp;&nbsp;norm&nbsp;=&nbsp;np.linalg.norm(vec)<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;norm&nbsp;==&nbsp;0:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;vec<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;vec&nbsp;/&nbsp;norm<br>
<br>
<br>
@dataclass<br>
class&nbsp;Light:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Один&nbsp;источник&nbsp;света&nbsp;с&nbsp;классическими&nbsp;параметрами.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;``direction``&nbsp;—&nbsp;продольная&nbsp;ось&nbsp;источника&nbsp;(из&nbsp;источника&nbsp;в&nbsp;сцену).&nbsp;В&nbsp;шейдерах<br>
&nbsp;&nbsp;&nbsp;&nbsp;используем&nbsp;``-direction``&nbsp;как&nbsp;входящее&nbsp;направление&nbsp;для&nbsp;направленного&nbsp;света.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;LightType<br>
&nbsp;&nbsp;&nbsp;&nbsp;color:&nbsp;np.ndarray&nbsp;=&nbsp;field(default_factory=lambda:&nbsp;np.ones(3,&nbsp;dtype=np.float32))<br>
&nbsp;&nbsp;&nbsp;&nbsp;intensity:&nbsp;float&nbsp;=&nbsp;1.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;direction:&nbsp;Optional[np.ndarray]&nbsp;=&nbsp;None<br>
&nbsp;&nbsp;&nbsp;&nbsp;position:&nbsp;Optional[np.ndarray]&nbsp;=&nbsp;None<br>
&nbsp;&nbsp;&nbsp;&nbsp;range:&nbsp;Optional[float]&nbsp;=&nbsp;None<br>
&nbsp;&nbsp;&nbsp;&nbsp;inner_angle:&nbsp;float&nbsp;=&nbsp;np.deg2rad(15.0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;outer_angle:&nbsp;float&nbsp;=&nbsp;np.deg2rad(30.0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;attenuation:&nbsp;AttenuationCoefficients&nbsp;=&nbsp;field(default_factory=AttenuationCoefficients)<br>
&nbsp;&nbsp;&nbsp;&nbsp;shadows:&nbsp;LightShadowParams&nbsp;=&nbsp;field(default_factory=LightShadowParams)<br>
&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;Optional[str]&nbsp;=&nbsp;None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__post_init__(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.color&nbsp;=&nbsp;np.asarray(self.color,&nbsp;dtype=np.float32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.color.shape&nbsp;!=&nbsp;(3,):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(&quot;Light&nbsp;color&nbsp;must&nbsp;be&nbsp;an&nbsp;RGB&nbsp;triplet.&quot;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.direction&nbsp;is&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.direction&nbsp;=&nbsp;np.array([0.0,&nbsp;-1.0,&nbsp;0.0],&nbsp;dtype=np.float32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.direction&nbsp;=&nbsp;_normalize(np.asarray(self.direction,&nbsp;dtype=np.float32))<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.position&nbsp;is&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.position&nbsp;=&nbsp;np.zeros(3,&nbsp;dtype=np.float32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.position&nbsp;=&nbsp;np.asarray(self.position,&nbsp;dtype=np.float32)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.outer_angle&nbsp;&lt;&nbsp;self.inner_angle:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.outer_angle&nbsp;=&nbsp;self.inner_angle<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;@property<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;intensity_rgb(self)&nbsp;-&gt;&nbsp;np.ndarray:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Вектор&nbsp;интенсивности&nbsp;излучения&nbsp;``I&nbsp;=&nbsp;intensity&nbsp;*&nbsp;color``.&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.color&nbsp;*&nbsp;float(self.intensity)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_distance_weight(self,&nbsp;distance:&nbsp;float)&nbsp;-&gt;&nbsp;float:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;=&nbsp;self.attenuation.evaluate(distance)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.range&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;distance&nbsp;&gt;&nbsp;self.range:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;=&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;weight<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;_spot_weight(self,&nbsp;L:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;float:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Плавный&nbsp;вес&nbsp;прожектора&nbsp;по&nbsp;углу&nbsp;между&nbsp;осью&nbsp;и&nbsp;``-L``.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Косинусная&nbsp;формула&nbsp;прожектора:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;``w&nbsp;=&nbsp;clamp((cos(theta)&nbsp;-&nbsp;cos_o)&nbsp;/&nbsp;(cos_i&nbsp;-&nbsp;cos_o),&nbsp;0,&nbsp;1)``,&nbsp;где<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;``theta``&nbsp;—&nbsp;угол&nbsp;между&nbsp;осью&nbsp;прожектора&nbsp;и&nbsp;направлением&nbsp;к&nbsp;точке.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_theta&nbsp;=&nbsp;np.dot(self.direction,&nbsp;-L)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_outer&nbsp;=&nbsp;np.cos(self.outer_angle)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos_inner&nbsp;=&nbsp;np.cos(self.inner_angle)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cos_theta&nbsp;&lt;=&nbsp;cos_outer:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0.0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cos_theta&nbsp;&gt;=&nbsp;cos_inner:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1.0<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;(cos_theta&nbsp;-&nbsp;cos_outer)&nbsp;/&nbsp;(cos_inner&nbsp;-&nbsp;cos_outer)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;t&nbsp;*&nbsp;t&nbsp;*&nbsp;(3.0&nbsp;-&nbsp;2.0&nbsp;*&nbsp;t)&nbsp;&nbsp;#&nbsp;smoothstep<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;sample(self,&nbsp;point:&nbsp;np.ndarray)&nbsp;-&gt;&nbsp;LightSample:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Оценить&nbsp;вклад&nbsp;света&nbsp;в&nbsp;точке&nbsp;``point``&nbsp;(мировое&nbsp;пространство).&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.type&nbsp;==&nbsp;LightType.AMBIENT:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;LightSample(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=np.zeros(3,&nbsp;dtype=np.float32),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance=np.inf,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attenuation=1.0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;radiance=self.intensity_rgb,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.type&nbsp;==&nbsp;LightType.DIRECTIONAL:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incoming&nbsp;=&nbsp;-_normalize(self.direction)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;LightSample(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=incoming,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance=np.inf,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attenuation=1.0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;radiance=self.intensity_rgb,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to_light&nbsp;=&nbsp;np.asarray(self.position&nbsp;-&nbsp;point,&nbsp;dtype=np.float32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance&nbsp;=&nbsp;float(np.linalg.norm(to_light))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;distance&nbsp;&lt;=&nbsp;1e-6:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;=&nbsp;np.array([0.0,&nbsp;1.0,&nbsp;0.0],&nbsp;dtype=np.float32)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;=&nbsp;to_light&nbsp;/&nbsp;distance<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attenuation&nbsp;=&nbsp;self._distance_weight(distance)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.type&nbsp;==&nbsp;LightType.SPOT:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attenuation&nbsp;*=&nbsp;self._spot_weight(L)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;LightSample(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L=L,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance=distance,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attenuation=attenuation,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;radiance=self.intensity_rgb&nbsp;*&nbsp;attenuation,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;to_uniform_dict(self)&nbsp;-&gt;&nbsp;dict:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Упаковать&nbsp;параметры&nbsp;в&nbsp;словарь&nbsp;для&nbsp;загрузки&nbsp;в&nbsp;uniform-пакеты.&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;type&quot;:&nbsp;self.type.value,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;color&quot;:&nbsp;self.color.tolist(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;intensity&quot;:&nbsp;float(self.intensity),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;direction&quot;:&nbsp;_normalize(self.direction).tolist(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;position&quot;:&nbsp;self.position.tolist(),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;range&quot;:&nbsp;None&nbsp;if&nbsp;self.range&nbsp;is&nbsp;None&nbsp;else&nbsp;float(self.range),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inner_angle&quot;:&nbsp;float(self.inner_angle),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;outer_angle&quot;:&nbsp;float(self.outer_angle),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;attenuation&quot;:&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;constant&quot;:&nbsp;float(self.attenuation.constant),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;linear&quot;:&nbsp;float(self.attenuation.linear),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;quadratic&quot;:&nbsp;float(self.attenuation.quadratic),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;shadows&quot;:&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;enabled&quot;:&nbsp;bool(self.shadows.enabled),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;bias&quot;:&nbsp;float(self.shadows.bias),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;normal_bias&quot;:&nbsp;float(self.shadows.normal_bias),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;map_resolution&quot;:&nbsp;int(self.shadows.map_resolution),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;name&quot;:&nbsp;self.name,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<!-- END SCAT CODE -->
</body>
</html>
