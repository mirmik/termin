<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>termin/visualization/render/skybox.py</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
#&nbsp;skybox.py<br>
&quot;&quot;&quot;Skybox&nbsp;shaders&nbsp;and&nbsp;geometry&nbsp;utilities.&quot;&quot;&quot;<br>
<br>
from&nbsp;__future__&nbsp;import&nbsp;annotations<br>
import&nbsp;numpy&nbsp;as&nbsp;np<br>
<br>
<br>
SKYBOX_VERTEX_SHADER&nbsp;=&nbsp;&quot;&quot;&quot;<br>
#version&nbsp;330&nbsp;core<br>
layout(location&nbsp;=&nbsp;0)&nbsp;in&nbsp;vec3&nbsp;a_position;<br>
<br>
uniform&nbsp;mat4&nbsp;u_view;<br>
uniform&nbsp;mat4&nbsp;u_projection;<br>
<br>
out&nbsp;vec3&nbsp;v_dir;<br>
<br>
void&nbsp;main()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Убираем&nbsp;трансляцию&nbsp;камеры&nbsp;—&nbsp;skybox&nbsp;не&nbsp;должен&nbsp;двигаться<br>
&nbsp;&nbsp;&nbsp;&nbsp;mat4&nbsp;view_no_translation&nbsp;=&nbsp;mat4(mat3(u_view));<br>
&nbsp;&nbsp;&nbsp;&nbsp;v_dir&nbsp;=&nbsp;a_position;<br>
&nbsp;&nbsp;&nbsp;&nbsp;gl_Position&nbsp;=&nbsp;u_projection&nbsp;*&nbsp;view_no_translation&nbsp;*&nbsp;vec4(a_position,&nbsp;1.0);<br>
}<br>
&quot;&quot;&quot;<br>
<br>
SKYBOX_GRADIENT_FRAGMENT_SHADER&nbsp;=&nbsp;&quot;&quot;&quot;<br>
#version&nbsp;330&nbsp;core<br>
<br>
in&nbsp;vec3&nbsp;v_dir;<br>
out&nbsp;vec4&nbsp;FragColor;<br>
<br>
uniform&nbsp;vec3&nbsp;u_skybox_top_color;<br>
uniform&nbsp;vec3&nbsp;u_skybox_bottom_color;<br>
<br>
void&nbsp;main()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Вертикальный&nbsp;градиент&nbsp;по&nbsp;оси&nbsp;Z&nbsp;(вверх&nbsp;в&nbsp;нашей&nbsp;СК)<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;t&nbsp;=&nbsp;normalize(v_dir).z&nbsp;*&nbsp;0.5&nbsp;+&nbsp;0.5;<br>
&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(mix(u_skybox_bottom_color,&nbsp;u_skybox_top_color,&nbsp;t),&nbsp;1.0);<br>
}<br>
&quot;&quot;&quot;<br>
<br>
#&nbsp;Keep&nbsp;old&nbsp;name&nbsp;for&nbsp;compatibility<br>
SKYBOX_FRAGMENT_SHADER&nbsp;=&nbsp;SKYBOX_GRADIENT_FRAGMENT_SHADER<br>
<br>
SKYBOX_SOLID_FRAGMENT_SHADER&nbsp;=&nbsp;&quot;&quot;&quot;<br>
#version&nbsp;330&nbsp;core<br>
<br>
in&nbsp;vec3&nbsp;v_dir;<br>
out&nbsp;vec4&nbsp;FragColor;<br>
<br>
uniform&nbsp;vec3&nbsp;u_skybox_color;<br>
<br>
void&nbsp;main()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(u_skybox_color,&nbsp;1.0);<br>
}<br>
&quot;&quot;&quot;<br>
<br>
<br>
def&nbsp;_skybox_cube():<br>
&nbsp;&nbsp;&nbsp;&nbsp;F&nbsp;=&nbsp;1.0&nbsp;&nbsp;#&nbsp;большой&nbsp;размер&nbsp;куба<br>
&nbsp;&nbsp;&nbsp;&nbsp;vertices&nbsp;=&nbsp;np.array([<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-F,&nbsp;-F,&nbsp;-F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;F,&nbsp;-F,&nbsp;-F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;F,&nbsp;&nbsp;F,&nbsp;-F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-F,&nbsp;&nbsp;F,&nbsp;-F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-F,&nbsp;-F,&nbsp;&nbsp;F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;F,&nbsp;-F,&nbsp;&nbsp;F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;F,&nbsp;&nbsp;F,&nbsp;&nbsp;F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-F,&nbsp;&nbsp;F,&nbsp;&nbsp;F],<br>
&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;dtype=np.float32)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;triangles&nbsp;=&nbsp;np.array([<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;1,&nbsp;2],&nbsp;[0,&nbsp;2,&nbsp;3],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;back<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4,&nbsp;6,&nbsp;5],&nbsp;[4,&nbsp;7,&nbsp;6],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;front<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;4,&nbsp;5],&nbsp;[0,&nbsp;5,&nbsp;1],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;bottom<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3,&nbsp;2,&nbsp;6],&nbsp;[3,&nbsp;6,&nbsp;7],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;top<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;5,&nbsp;6],&nbsp;[1,&nbsp;6,&nbsp;2],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;right<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;3,&nbsp;7],&nbsp;[0,&nbsp;7,&nbsp;4],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;left<br>
&nbsp;&nbsp;&nbsp;&nbsp;],&nbsp;dtype=np.uint32)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;vertices,&nbsp;triangles<br>
<!-- END SCAT CODE -->
</body>
</html>
