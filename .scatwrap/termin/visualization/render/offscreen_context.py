<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>termin/visualization/render/offscreen_context.py</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
&quot;&quot;&quot;<br>
OffscreenContext&nbsp;—&nbsp;dedicated&nbsp;GL&nbsp;context&nbsp;для&nbsp;offscreen&nbsp;рендеринга.<br>
<br>
Все&nbsp;GPU&nbsp;ресурсы&nbsp;живут&nbsp;в&nbsp;этом&nbsp;контексте.&nbsp;Дисплеи&nbsp;share&nbsp;context&nbsp;с&nbsp;ним,<br>
что&nbsp;позволяет&nbsp;рендерить&nbsp;в&nbsp;одном&nbsp;контексте&nbsp;и&nbsp;блитать&nbsp;результат&nbsp;на&nbsp;любой&nbsp;дисплей.<br>
<br>
Преимущества:<br>
-&nbsp;Симметричность:&nbsp;все&nbsp;дисплеи&nbsp;равноправны<br>
-&nbsp;Независимость:&nbsp;рендеринг&nbsp;работает&nbsp;даже&nbsp;без&nbsp;дисплеев<br>
-&nbsp;Один&nbsp;context_key&nbsp;для&nbsp;всех&nbsp;ресурсов<br>
-&nbsp;Scene&nbsp;pipelines&nbsp;могут&nbsp;охватывать&nbsp;viewports&nbsp;на&nbsp;разных&nbsp;дисплеях<br>
<br>
Использование:<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Создание&nbsp;контекста<br>
&nbsp;&nbsp;&nbsp;&nbsp;context&nbsp;=&nbsp;OffscreenContext()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Все&nbsp;дисплеи&nbsp;должны&nbsp;share&nbsp;context&nbsp;с&nbsp;ним<br>
&nbsp;&nbsp;&nbsp;&nbsp;window_backend&nbsp;=&nbsp;SDLEmbeddedWindowBackend(share_context=context.gl_context)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Рендеринг<br>
&nbsp;&nbsp;&nbsp;&nbsp;context.make_current()<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;...&nbsp;render&nbsp;to&nbsp;FBOs&nbsp;...<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Освобождение<br>
&nbsp;&nbsp;&nbsp;&nbsp;context.destroy()<br>
&quot;&quot;&quot;<br>
<br>
from&nbsp;__future__&nbsp;import&nbsp;annotations<br>
<br>
from&nbsp;typing&nbsp;import&nbsp;TYPE_CHECKING,&nbsp;Optional<br>
<br>
if&nbsp;TYPE_CHECKING:<br>
&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;termin.visualization.platform.backends.base&nbsp;import&nbsp;GraphicsBackend<br>
<br>
<br>
class&nbsp;OffscreenContext:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Dedicated&nbsp;offscreen&nbsp;GL&nbsp;context&nbsp;для&nbsp;рендеринга.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Создаёт&nbsp;hidden&nbsp;SDL&nbsp;window&nbsp;с&nbsp;GL&nbsp;context.&nbsp;Все&nbsp;GPU&nbsp;ресурсы<br>
&nbsp;&nbsp;&nbsp;&nbsp;(FBO,&nbsp;текстуры,&nbsp;шейдеры,&nbsp;VAO)&nbsp;живут&nbsp;в&nbsp;этом&nbsp;контексте.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;Дисплеи&nbsp;создаются&nbsp;с&nbsp;shared&nbsp;context,&nbsp;что&nbsp;позволяет:<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Рендерить&nbsp;всё&nbsp;в&nbsp;одном&nbsp;контексте<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Блитать&nbsp;FBO&nbsp;на&nbsp;любой&nbsp;дисплей<br>
&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Избежать&nbsp;дублирования&nbsp;ресурсов<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Единственный&nbsp;context_key&nbsp;-&nbsp;всё&nbsp;в&nbsp;одном&nbsp;контексте<br>
&nbsp;&nbsp;&nbsp;&nbsp;CONTEXT_KEY:&nbsp;int&nbsp;=&nbsp;0<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Создаёт&nbsp;hidden&nbsp;SDL&nbsp;window&nbsp;с&nbsp;GL&nbsp;context.&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;sdl2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sdl2&nbsp;import&nbsp;video<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._window&nbsp;=&nbsp;None<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._gl_context&nbsp;=&nbsp;None<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._graphics:&nbsp;Optional[GraphicsBackend]&nbsp;=&nbsp;None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;SDL&nbsp;must&nbsp;be&nbsp;initialized&nbsp;by&nbsp;caller&nbsp;(e.g.,&nbsp;in&nbsp;run_editor.py)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;OpenGL&nbsp;3.3&nbsp;Core<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_CONTEXT_MAJOR_VERSION,&nbsp;3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_CONTEXT_MINOR_VERSION,&nbsp;3)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_CONTEXT_PROFILE_MASK,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_CONTEXT_PROFILE_CORE,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_DOUBLEBUFFER,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_DEPTH_SIZE,&nbsp;24)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Use&nbsp;10-bit&nbsp;color&nbsp;(best&nbsp;balance:&nbsp;no&nbsp;banding,&nbsp;no&nbsp;Windows&nbsp;HDR&nbsp;issues)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_RED_SIZE,&nbsp;8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_GREEN_SIZE,&nbsp;8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_SetAttribute(video.SDL_GL_BLUE_SIZE,&nbsp;8)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Hidden&nbsp;window&nbsp;-&nbsp;minimal&nbsp;size,&nbsp;not&nbsp;visible<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags&nbsp;=&nbsp;video.SDL_WINDOW_OPENGL&nbsp;|&nbsp;video.SDL_WINDOW_HIDDEN<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._window&nbsp;=&nbsp;video.SDL_CreateWindow(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&quot;OffscreenContext&quot;,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,&nbsp;1,&nbsp;&nbsp;#&nbsp;minimal&nbsp;size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self._window:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;RuntimeError(f&quot;Failed&nbsp;to&nbsp;create&nbsp;SDL&nbsp;window:&nbsp;{sdl2.SDL_GetError()}&quot;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._gl_context&nbsp;=&nbsp;video.SDL_GL_CreateContext(self._window)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self._gl_context:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_DestroyWindow(self._window)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._window&nbsp;=&nbsp;None<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;RuntimeError(f&quot;Failed&nbsp;to&nbsp;create&nbsp;GL&nbsp;context:&nbsp;{sdl2.SDL_GetError()}&quot;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;current&nbsp;and&nbsp;initialize&nbsp;graphics&nbsp;backend<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.make_current()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;termin.graphics&nbsp;import&nbsp;OpenGLGraphicsBackend<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._graphics&nbsp;=&nbsp;OpenGLGraphicsBackend()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Ensure&nbsp;OpenGL&nbsp;functions&nbsp;are&nbsp;loaded<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._graphics.ensure_ready()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;@property<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;graphics(self)&nbsp;-&gt;&nbsp;&quot;GraphicsBackend&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;GraphicsBackend&nbsp;для&nbsp;этого&nbsp;контекста.&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._graphics<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;@property<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;gl_context(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GL&nbsp;context&nbsp;для&nbsp;sharing&nbsp;с&nbsp;дисплеями.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Передайте&nbsp;это&nbsp;значение&nbsp;в&nbsp;SDLEmbeddedWindowBackend&nbsp;при&nbsp;создании<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;окон,&nbsp;чтобы&nbsp;они&nbsp;использовали&nbsp;shared&nbsp;context.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._gl_context<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;@property<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;context_key(self)&nbsp;-&gt;&nbsp;int:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Context&nbsp;key&nbsp;для&nbsp;GPU&nbsp;ресурсов.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Всегда&nbsp;возвращает&nbsp;CONTEXT_KEY&nbsp;(0),&nbsp;так&nbsp;как&nbsp;все&nbsp;ресурсы<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;живут&nbsp;в&nbsp;одном&nbsp;контексте.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.CONTEXT_KEY<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;make_current(self)&nbsp;-&gt;&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Активирует&nbsp;GL&nbsp;контекст.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вызывайте&nbsp;перед&nbsp;любыми&nbsp;OpenGL&nbsp;операциями.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sdl2&nbsp;import&nbsp;video<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._window&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;self._gl_context&nbsp;is&nbsp;not&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;video.SDL_GL_MakeCurrent(self._window,&nbsp;self._gl_context)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;result&nbsp;!=&nbsp;0:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;sdl2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;termin._native&nbsp;import&nbsp;log<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log.error(f&quot;[OffscreenContext]&nbsp;SDL_GL_MakeCurrent&nbsp;failed:&nbsp;{sdl2.SDL_GetError()}&quot;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;is_valid(self)&nbsp;-&gt;&nbsp;bool:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;Проверяет,&nbsp;валиден&nbsp;ли&nbsp;контекст.&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._window&nbsp;is&nbsp;not&nbsp;None&nbsp;and&nbsp;self._gl_context&nbsp;is&nbsp;not&nbsp;None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;destroy(self)&nbsp;-&gt;&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Освобождает&nbsp;ресурсы&nbsp;контекста.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;После&nbsp;вызова&nbsp;контекст&nbsp;нельзя&nbsp;использовать.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;sdl2&nbsp;import&nbsp;video<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._gl_context&nbsp;is&nbsp;not&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_GL_DeleteContext(self._gl_context)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._gl_context&nbsp;=&nbsp;None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._window&nbsp;is&nbsp;not&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;video.SDL_DestroyWindow(self._window)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._window&nbsp;=&nbsp;None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._graphics&nbsp;=&nbsp;None<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__enter__(self)&nbsp;-&gt;&nbsp;&quot;OffscreenContext&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__exit__(self,&nbsp;exc_type,&nbsp;exc_val,&nbsp;exc_tb)&nbsp;-&gt;&nbsp;None:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.destroy()<br>
<!-- END SCAT CODE -->
</body>
</html>
