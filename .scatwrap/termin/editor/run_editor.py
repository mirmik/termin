<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>termin/editor/run_editor.py</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
import&nbsp;sys<br>
<br>
import&nbsp;numpy&nbsp;as&nbsp;np<br>
from&nbsp;PyQt5.QtGui&nbsp;import&nbsp;QPalette,&nbsp;QColor<br>
from&nbsp;PyQt5.QtWidgets&nbsp;import&nbsp;QApplication<br>
<br>
from&nbsp;termin.editor.editor_window&nbsp;import&nbsp;EditorWindow<br>
from&nbsp;termin.geombase.pose3&nbsp;import&nbsp;Pose3<br>
from&nbsp;termin.mesh.mesh&nbsp;import&nbsp;CubeMesh,&nbsp;CylinderMesh,&nbsp;Mesh3<br>
from&nbsp;termin.visualization.core.camera&nbsp;import&nbsp;PerspectiveCameraComponent,&nbsp;OrbitCameraController<br>
from&nbsp;termin.visualization.core.entity&nbsp;import&nbsp;Entity<br>
from&nbsp;termin.visualization.core.material&nbsp;import&nbsp;Material<br>
from&nbsp;termin.visualization.core.mesh&nbsp;import&nbsp;MeshDrawable<br>
from&nbsp;termin.visualization.core.scene&nbsp;import&nbsp;Scene<br>
from&nbsp;termin.visualization.core.world&nbsp;import&nbsp;VisualizationWorld<br>
from&nbsp;termin.visualization.platform.backends&nbsp;import&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;OpenGLGraphicsBackend,<br>
&nbsp;&nbsp;&nbsp;&nbsp;QtWindowBackend,<br>
&nbsp;&nbsp;&nbsp;&nbsp;set_default_graphics_backend,<br>
&nbsp;&nbsp;&nbsp;&nbsp;set_default_window_backend,<br>
)<br>
from&nbsp;termin.visualization.render.components&nbsp;import&nbsp;MeshRenderer<br>
from&nbsp;termin.visualization.render.skybox&nbsp;import&nbsp;SkyBoxEntity<br>
<br>
def&nbsp;build_scene(world):<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;cube_mesh&nbsp;=&nbsp;CubeMesh()<br>
&nbsp;&nbsp;&nbsp;&nbsp;cyl_mesh&nbsp;=&nbsp;CylinderMesh(radius=0.5,&nbsp;height=2.0)<br>
&nbsp;&nbsp;&nbsp;&nbsp;drawable&nbsp;=&nbsp;MeshDrawable(cube_mesh)<br>
&nbsp;&nbsp;&nbsp;&nbsp;drawable_cyl&nbsp;=&nbsp;MeshDrawable(cyl_mesh)<br>
&nbsp;&nbsp;&nbsp;&nbsp;red_material&nbsp;=&nbsp;Material(color=np.array([0.8,&nbsp;0.3,&nbsp;0.3,&nbsp;1.0],&nbsp;dtype=np.float32))<br>
&nbsp;&nbsp;&nbsp;&nbsp;blue_material&nbsp;=&nbsp;Material(color=np.array([0.3,&nbsp;0.3,&nbsp;0.8,&nbsp;1.0],&nbsp;dtype=np.float32))<br>
&nbsp;&nbsp;&nbsp;&nbsp;green_material&nbsp;=&nbsp;Material(color=np.array([0.3,&nbsp;0.8,&nbsp;0.3,&nbsp;1.0],&nbsp;dtype=np.float32))<br>
&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene&nbsp;=&nbsp;Scene()<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity_cyl&nbsp;=&nbsp;Entity(pose=Pose3.identity(),&nbsp;name=&quot;cylinder&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity_cyl.add_component(MeshRenderer(drawable_cyl,&nbsp;green_material))<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity_cyl.transform.relocate(Pose3(lin=np.array([-2.0,&nbsp;0.0,&nbsp;0.0]),&nbsp;ang=np.array([0.0,&nbsp;0.0,&nbsp;0.0,&nbsp;1.0])))<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(entity_cyl)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity&nbsp;=&nbsp;Entity(pose=Pose3.identity(),&nbsp;name=&quot;cube1&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity.add_component(MeshRenderer(drawable,&nbsp;red_material))<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(entity)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity2&nbsp;=&nbsp;Entity(pose=Pose3.identity(),&nbsp;name=&quot;cube2&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity2.add_component(MeshRenderer(drawable,&nbsp;blue_material))<br>
&nbsp;&nbsp;&nbsp;&nbsp;entity2.transform.relocate(Pose3(lin=np.array([3.0,&nbsp;0.0,&nbsp;0.0]),&nbsp;ang=np.array([0.0,&nbsp;0.0,&nbsp;0.0,&nbsp;1.0])))<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(entity2)<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;skybox&nbsp;=&nbsp;SkyBoxEntity()<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(skybox)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;world.add_scene(scene)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;scene<br>
<br>
<br>
def&nbsp;apply_dark_palette(app:&nbsp;QApplication):<br>
&nbsp;&nbsp;&nbsp;&nbsp;app.setStyle(&quot;Fusion&quot;)&nbsp;&nbsp;#&nbsp;более&nbsp;аккуратный&nbsp;стиль,&nbsp;чем&nbsp;дефолтный<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette&nbsp;=&nbsp;QPalette()<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Базовые&nbsp;цвета<br>
&nbsp;&nbsp;&nbsp;&nbsp;bg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;QColor(30,&nbsp;30,&nbsp;30)<br>
&nbsp;&nbsp;&nbsp;&nbsp;window&nbsp;&nbsp;=&nbsp;QColor(37,&nbsp;37,&nbsp;38)<br>
&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;QColor(45,&nbsp;45,&nbsp;48)<br>
&nbsp;&nbsp;&nbsp;&nbsp;text&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;QColor(220,&nbsp;220,&nbsp;220)<br>
&nbsp;&nbsp;&nbsp;&nbsp;disabled_text&nbsp;=&nbsp;QColor(128,&nbsp;128,&nbsp;128)<br>
&nbsp;&nbsp;&nbsp;&nbsp;highlight&nbsp;=&nbsp;QColor(0,&nbsp;120,&nbsp;215)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Window,&nbsp;window)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.WindowText,&nbsp;text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Base,&nbsp;base)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.AlternateBase,&nbsp;bg)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.ToolTipBase,&nbsp;base)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.ToolTipText,&nbsp;text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Text,&nbsp;text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Button,&nbsp;window)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.ButtonText,&nbsp;text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.BrightText,&nbsp;QColor(255,&nbsp;0,&nbsp;0))<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Highlight,&nbsp;highlight)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.HighlightedText,&nbsp;QColor(255,&nbsp;255,&nbsp;255))<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Отключённые&nbsp;элементы<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Disabled,&nbsp;QPalette.Text,&nbsp;disabled_text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Disabled,&nbsp;QPalette.ButtonText,&nbsp;disabled_text)<br>
&nbsp;&nbsp;&nbsp;&nbsp;palette.setColor(QPalette.Disabled,&nbsp;QPalette.WindowText,&nbsp;disabled_text)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;app.setPalette(palette)<br>
<br>
<br>
def&nbsp;run_editor():<br>
&nbsp;&nbsp;&nbsp;&nbsp;app&nbsp;=&nbsp;QApplication(sys.argv)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;set_default_graphics_backend(OpenGLGraphicsBackend())<br>
&nbsp;&nbsp;&nbsp;&nbsp;set_default_window_backend(QtWindowBackend())<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;world&nbsp;=&nbsp;VisualizationWorld()<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene&nbsp;=&nbsp;build_scene(world)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;apply_dark_palette(app)<br>
&nbsp;&nbsp;&nbsp;&nbsp;win&nbsp;=&nbsp;EditorWindow(world,&nbsp;scene)<br>
&nbsp;&nbsp;&nbsp;&nbsp;win.show()<br>
&nbsp;&nbsp;&nbsp;&nbsp;app.exec_()<br>
<br>
<br>
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;run_editor()<br>
<!-- END SCAT CODE -->
</body>
</html>
