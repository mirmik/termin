<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>examples/project/stdlib/glsl/common.glsl</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
/**<br>
&nbsp;*&nbsp;Common&nbsp;GLSL&nbsp;utilities&nbsp;for&nbsp;Termin&nbsp;engine.<br>
&nbsp;*<br>
&nbsp;*&nbsp;Usage&nbsp;in&nbsp;your&nbsp;shader:<br>
&nbsp;*&nbsp;&nbsp;&nbsp;#include&nbsp;&quot;common&quot;<br>
&nbsp;*<br>
&nbsp;*&nbsp;Provides:<br>
&nbsp;*&nbsp;&nbsp;&nbsp;-&nbsp;Constants&nbsp;(PI,&nbsp;etc.)<br>
&nbsp;*&nbsp;&nbsp;&nbsp;-&nbsp;Common&nbsp;math&nbsp;functions<br>
&nbsp;*&nbsp;&nbsp;&nbsp;-&nbsp;Color&nbsp;space&nbsp;conversions<br>
&nbsp;*/<br>
<br>
#ifndef&nbsp;COMMON_GLSL<br>
#define&nbsp;COMMON_GLSL<br>
<br>
//&nbsp;==============&nbsp;Constants&nbsp;==============<br>
const&nbsp;float&nbsp;PI&nbsp;=&nbsp;3.14159265359;<br>
const&nbsp;float&nbsp;TWO_PI&nbsp;=&nbsp;6.28318530718;<br>
const&nbsp;float&nbsp;HALF_PI&nbsp;=&nbsp;1.57079632679;<br>
const&nbsp;float&nbsp;INV_PI&nbsp;=&nbsp;0.31830988618;<br>
<br>
const&nbsp;float&nbsp;EPSILON&nbsp;=&nbsp;0.0001;<br>
<br>
//&nbsp;==============&nbsp;Math&nbsp;utilities&nbsp;==============<br>
<br>
/**<br>
&nbsp;*&nbsp;Remap&nbsp;value&nbsp;from&nbsp;one&nbsp;range&nbsp;to&nbsp;another.<br>
&nbsp;*/<br>
float&nbsp;remap(float&nbsp;value,&nbsp;float&nbsp;from_min,&nbsp;float&nbsp;from_max,&nbsp;float&nbsp;to_min,&nbsp;float&nbsp;to_max)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;t&nbsp;=&nbsp;(value&nbsp;-&nbsp;from_min)&nbsp;/&nbsp;(from_max&nbsp;-&nbsp;from_min);<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mix(to_min,&nbsp;to_max,&nbsp;t);<br>
}<br>
<br>
/**<br>
&nbsp;*&nbsp;Saturate&nbsp;(clamp&nbsp;to&nbsp;0-1).<br>
&nbsp;*/<br>
float&nbsp;saturate(float&nbsp;x)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;clamp(x,&nbsp;0.0,&nbsp;1.0);<br>
}<br>
<br>
vec3&nbsp;saturate(vec3&nbsp;x)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;clamp(x,&nbsp;0.0,&nbsp;1.0);<br>
}<br>
<br>
/**<br>
&nbsp;*&nbsp;Square&nbsp;of&nbsp;a&nbsp;value.<br>
&nbsp;*/<br>
float&nbsp;sq(float&nbsp;x)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;x&nbsp;*&nbsp;x;<br>
}<br>
<br>
//&nbsp;==============&nbsp;Color&nbsp;utilities&nbsp;==============<br>
<br>
/**<br>
&nbsp;*&nbsp;sRGB&nbsp;to&nbsp;linear&nbsp;color&nbsp;space.<br>
&nbsp;*/<br>
vec3&nbsp;srgb_to_linear(vec3&nbsp;color)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;pow(color,&nbsp;vec3(2.2));<br>
}<br>
<br>
/**<br>
&nbsp;*&nbsp;Linear&nbsp;to&nbsp;sRGB&nbsp;color&nbsp;space.<br>
&nbsp;*/<br>
vec3&nbsp;linear_to_srgb(vec3&nbsp;color)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;pow(color,&nbsp;vec3(1.0&nbsp;/&nbsp;2.2));<br>
}<br>
<br>
/**<br>
&nbsp;*&nbsp;Luminance&nbsp;(perceived&nbsp;brightness).<br>
&nbsp;*/<br>
float&nbsp;luminance(vec3&nbsp;color)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;dot(color,&nbsp;vec3(0.2126,&nbsp;0.7152,&nbsp;0.0722));<br>
}<br>
<br>
//&nbsp;==============&nbsp;Normal&nbsp;mapping&nbsp;utilities&nbsp;==============<br>
<br>
/**<br>
&nbsp;*&nbsp;Unpack&nbsp;normal&nbsp;from&nbsp;normal&nbsp;map&nbsp;(0-1&nbsp;to&nbsp;-1..1).<br>
&nbsp;*/<br>
vec3&nbsp;unpack_normal(vec3&nbsp;packed)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;packed&nbsp;*&nbsp;2.0&nbsp;-&nbsp;1.0;<br>
}<br>
<br>
/**<br>
&nbsp;*&nbsp;Construct&nbsp;TBN&nbsp;matrix&nbsp;from&nbsp;normal&nbsp;and&nbsp;tangent.<br>
&nbsp;*/<br>
mat3&nbsp;construct_tbn(vec3&nbsp;normal,&nbsp;vec4&nbsp;tangent)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;N&nbsp;=&nbsp;normalize(normal);<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;T&nbsp;=&nbsp;normalize(tangent.xyz);<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;B&nbsp;=&nbsp;cross(N,&nbsp;T)&nbsp;*&nbsp;tangent.w;<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mat3(T,&nbsp;B,&nbsp;N);<br>
}<br>
<br>
#endif&nbsp;//&nbsp;COMMON_GLSL<br>
<!-- END SCAT CODE -->
</body>
</html>
