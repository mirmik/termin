<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>examples/project/Materials/NavMeshPost.shader</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
@program&nbsp;NavMeshPost<br>
<br>
@phase&nbsp;opaque<br>
@priority&nbsp;0<br>
@glDepthTest&nbsp;false<br>
@glDepthMask&nbsp;false<br>
@glCull&nbsp;false<br>
<br>
@property&nbsp;Texture2D&nbsp;u_input_tex&nbsp;=&nbsp;&quot;white&quot;<br>
@property&nbsp;Texture2D&nbsp;u_depth_texture&nbsp;=&nbsp;&quot;depth_default&quot;<br>
@property&nbsp;Texture2D&nbsp;u_normal_texture&nbsp;=&nbsp;&quot;normal_default&quot;<br>
@property&nbsp;Texture2D&nbsp;u_fov&nbsp;=&nbsp;&quot;white&quot;<br>
@property&nbsp;Float&nbsp;u_fov_distance&nbsp;=&nbsp;100.0<br>
@property&nbsp;Float&nbsp;u_depth_bias&nbsp;=&nbsp;0.02<br>
<br>
@stage&nbsp;vertex<br>
#version&nbsp;330&nbsp;core<br>
<br>
layout(location&nbsp;=&nbsp;0)&nbsp;in&nbsp;vec2&nbsp;a_pos;<br>
layout(location&nbsp;=&nbsp;1)&nbsp;in&nbsp;vec2&nbsp;a_uv;<br>
<br>
out&nbsp;vec2&nbsp;v_uv;<br>
<br>
void&nbsp;main()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;v_uv&nbsp;=&nbsp;a_uv;<br>
&nbsp;&nbsp;&nbsp;&nbsp;gl_Position&nbsp;=&nbsp;vec4(a_pos,&nbsp;0.0,&nbsp;1.0);<br>
}<br>
@endstage<br>
<br>
@stage&nbsp;fragment<br>
#version&nbsp;330&nbsp;core<br>
<br>
in&nbsp;vec2&nbsp;v_uv;<br>
<br>
uniform&nbsp;sampler2D&nbsp;u_input_tex;<br>
uniform&nbsp;sampler2D&nbsp;u_depth_texture;<br>
uniform&nbsp;sampler2D&nbsp;u_normal_texture;<br>
uniform&nbsp;vec2&nbsp;u_resolution;<br>
uniform&nbsp;float&nbsp;u_time_modifier;<br>
uniform&nbsp;float&nbsp;u_grid_intensity;<br>
uniform&nbsp;float&nbsp;u_grid_scale;<br>
uniform&nbsp;float&nbsp;u_grid_line_width;<br>
uniform&nbsp;vec4&nbsp;u_grid_color;<br>
<br>
uniform&nbsp;float&nbsp;u_near;<br>
uniform&nbsp;float&nbsp;u_far;<br>
uniform&nbsp;mat4&nbsp;u_inv_view;<br>
uniform&nbsp;mat4&nbsp;u_inv_proj;<br>
<br>
uniform&nbsp;sampler2D&nbsp;u_fov;<br>
uniform&nbsp;mat4&nbsp;u_fov_view;<br>
uniform&nbsp;mat4&nbsp;u_fov_projection;<br>
uniform&nbsp;float&nbsp;u_fov_distance;<br>
uniform&nbsp;float&nbsp;u_depth_bias;<br>
uniform&nbsp;vec3&nbsp;u_fov_camera_pos;<br>
<br>
out&nbsp;vec4&nbsp;FragColor;<br>
<br>
//&nbsp;Reconstruct&nbsp;world&nbsp;position&nbsp;from&nbsp;depth&nbsp;and&nbsp;screen&nbsp;UV<br>
vec3&nbsp;reconstruct_world_pos(vec2&nbsp;uv,&nbsp;float&nbsp;linear_depth)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Screen&nbsp;UV&nbsp;to&nbsp;NDC&nbsp;xy&nbsp;(-1&nbsp;to&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec2&nbsp;ndc_xy&nbsp;=&nbsp;uv&nbsp;*&nbsp;2.0&nbsp;-&nbsp;1.0;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Unproject&nbsp;near&nbsp;and&nbsp;far&nbsp;points<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;near_ndc&nbsp;=&nbsp;vec4(ndc_xy,&nbsp;-1.0,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;far_ndc&nbsp;=&nbsp;vec4(ndc_xy,&nbsp;1.0,&nbsp;1.0);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;near_view&nbsp;=&nbsp;u_inv_proj&nbsp;*&nbsp;near_ndc;<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;far_view&nbsp;=&nbsp;u_inv_proj&nbsp;*&nbsp;far_ndc;<br>
&nbsp;&nbsp;&nbsp;&nbsp;near_view&nbsp;/=&nbsp;near_view.w;<br>
&nbsp;&nbsp;&nbsp;&nbsp;far_view&nbsp;/=&nbsp;far_view.w;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Interpolate&nbsp;between&nbsp;near&nbsp;and&nbsp;far&nbsp;based&nbsp;on&nbsp;linear&nbsp;depth<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;view_pos&nbsp;=&nbsp;mix(near_view.xyz,&nbsp;far_view.xyz,&nbsp;linear_depth);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Transform&nbsp;to&nbsp;world&nbsp;space<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;world_pos&nbsp;=&nbsp;u_inv_view&nbsp;*&nbsp;vec4(view_pos,&nbsp;1.0);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;world_pos.xyz;<br>
}<br>
<br>
//&nbsp;Single&nbsp;texel&nbsp;visibility&nbsp;test<br>
bool&nbsp;visibility_test(float&nbsp;fov_linear_depth,&nbsp;ivec2&nbsp;texel_coord,&nbsp;ivec2&nbsp;tex_size,&nbsp;float&nbsp;depth_bias)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;texel_coord&nbsp;=&nbsp;clamp(texel_coord,&nbsp;ivec2(0),&nbsp;tex_size&nbsp;-&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;stored_depth&nbsp;=&nbsp;texelFetch(u_fov,&nbsp;texel_coord,&nbsp;0).r&nbsp;*&nbsp;u_fov_distance;<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fov_linear_depth&nbsp;&lt;=&nbsp;stored_depth&nbsp;+&nbsp;depth_bias;<br>
}<br>
<br>
//&nbsp;Returns&nbsp;visibility&nbsp;as&nbsp;float&nbsp;[0..1]&nbsp;using&nbsp;bilinear&nbsp;interpolation&nbsp;of&nbsp;visibility&nbsp;tests<br>
float&nbsp;visibility_from_fov(vec3&nbsp;world_pos,&nbsp;float&nbsp;depth_bias)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Transform&nbsp;world&nbsp;position&nbsp;to&nbsp;FOV&nbsp;camera&nbsp;view&nbsp;space<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;fov_view_pos&nbsp;=&nbsp;u_fov_view&nbsp;*&nbsp;vec4(world_pos,&nbsp;1.0);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Linear&nbsp;depth&nbsp;in&nbsp;FOV&nbsp;camera&nbsp;space&nbsp;(forward&nbsp;=&nbsp;+Y)<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;fov_linear_depth&nbsp;=&nbsp;fov_view_pos.y;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;if&nbsp;in&nbsp;front&nbsp;of&nbsp;FOV&nbsp;camera<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(fov_linear_depth&nbsp;&lt;&nbsp;0.0)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;max&nbsp;distance<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(fov_linear_depth&nbsp;&gt;&nbsp;u_fov_distance)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Transform&nbsp;to&nbsp;FOV&nbsp;camera&nbsp;clip&nbsp;space<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;fov_clip_pos&nbsp;=&nbsp;u_fov_projection&nbsp;*&nbsp;fov_view_pos;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Perspective&nbsp;divide<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;ndc&nbsp;=&nbsp;fov_clip_pos.xyz&nbsp;/&nbsp;fov_clip_pos.w;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;if&nbsp;within&nbsp;FOV&nbsp;frustum&nbsp;[-1,&nbsp;1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ndc.x&nbsp;&lt;&nbsp;-1.0&nbsp;||&nbsp;ndc.x&nbsp;&gt;&nbsp;1.0&nbsp;||&nbsp;ndc.y&nbsp;&lt;&nbsp;-1.0&nbsp;||&nbsp;ndc.y&nbsp;&gt;&nbsp;1.0)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Convert&nbsp;NDC&nbsp;to&nbsp;UV&nbsp;[0,&nbsp;1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec2&nbsp;fov_uv&nbsp;=&nbsp;ndc.xy&nbsp;*&nbsp;0.5&nbsp;+&nbsp;0.5;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Get&nbsp;texture&nbsp;size&nbsp;and&nbsp;texel&nbsp;position<br>
&nbsp;&nbsp;&nbsp;&nbsp;ivec2&nbsp;tex_size&nbsp;=&nbsp;textureSize(u_fov,&nbsp;0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec2&nbsp;texel_pos&nbsp;=&nbsp;fov_uv&nbsp;*&nbsp;vec2(tex_size)&nbsp;-&nbsp;0.5;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Get&nbsp;the&nbsp;4&nbsp;nearest&nbsp;texel&nbsp;coordinates<br>
&nbsp;&nbsp;&nbsp;&nbsp;ivec2&nbsp;texel_00&nbsp;=&nbsp;ivec2(floor(texel_pos));<br>
&nbsp;&nbsp;&nbsp;&nbsp;ivec2&nbsp;texel_10&nbsp;=&nbsp;texel_00&nbsp;+&nbsp;ivec2(1,&nbsp;0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;ivec2&nbsp;texel_01&nbsp;=&nbsp;texel_00&nbsp;+&nbsp;ivec2(0,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;ivec2&nbsp;texel_11&nbsp;=&nbsp;texel_00&nbsp;+&nbsp;ivec2(1,&nbsp;1);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Bilinear&nbsp;weights<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec2&nbsp;f&nbsp;=&nbsp;fract(texel_pos);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Visibility&nbsp;test&nbsp;for&nbsp;each&nbsp;of&nbsp;4&nbsp;texels&nbsp;(0&nbsp;or&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;v00&nbsp;=&nbsp;visibility_test(fov_linear_depth,&nbsp;texel_00,&nbsp;tex_size,&nbsp;depth_bias)&nbsp;?&nbsp;1.0&nbsp;:&nbsp;0.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;v10&nbsp;=&nbsp;visibility_test(fov_linear_depth,&nbsp;texel_10,&nbsp;tex_size,&nbsp;depth_bias)&nbsp;?&nbsp;1.0&nbsp;:&nbsp;0.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;v01&nbsp;=&nbsp;visibility_test(fov_linear_depth,&nbsp;texel_01,&nbsp;tex_size,&nbsp;depth_bias)&nbsp;?&nbsp;1.0&nbsp;:&nbsp;0.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;v11&nbsp;=&nbsp;visibility_test(fov_linear_depth,&nbsp;texel_11,&nbsp;tex_size,&nbsp;depth_bias)&nbsp;?&nbsp;1.0&nbsp;:&nbsp;0.0;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Bilinear&nbsp;interpolation&nbsp;of&nbsp;visibility&nbsp;results<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;v_bottom&nbsp;=&nbsp;mix(v00,&nbsp;v10,&nbsp;f.x);<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;v_top&nbsp;=&nbsp;mix(v01,&nbsp;v11,&nbsp;f.x);<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mix(v_bottom,&nbsp;v_top,&nbsp;f.y);<br>
}<br>
<br>
//&nbsp;Bool&nbsp;version&nbsp;with&nbsp;threshold<br>
bool&nbsp;is_visible_from_fov(vec3&nbsp;world_pos,&nbsp;float&nbsp;depth_bias)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;visibility_from_fov(world_pos,&nbsp;depth_bias)&nbsp;&gt;=&nbsp;0.5;<br>
}<br>
<br>
float&nbsp;fov_linear_depth_from_world_pos(vec3&nbsp;world_pos)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Transform&nbsp;world&nbsp;position&nbsp;to&nbsp;FOV&nbsp;camera&nbsp;view&nbsp;space<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;fov_view_pos&nbsp;=&nbsp;u_fov_view&nbsp;*&nbsp;vec4(world_pos,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fov_view_pos.y;<br>
}<br>
<br>
void&nbsp;main()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec4&nbsp;color&nbsp;=&nbsp;texture(u_input_tex,&nbsp;v_uv);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Get&nbsp;linear&nbsp;depth&nbsp;from&nbsp;depth&nbsp;texture<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;linear_depth&nbsp;=&nbsp;texture(u_depth_texture,&nbsp;v_uv).r;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//Debug:&nbsp;just&nbsp;pass&nbsp;through&nbsp;depth&nbsp;value&nbsp;unchanged<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;FragColor&nbsp;=&nbsp;vec4(linear_depth,&nbsp;linear_depth,&nbsp;linear_depth,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;//&nbsp;Skip&nbsp;sky/far&nbsp;pixels<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;(linear_depth&nbsp;&gt;=&nbsp;1.0)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;color;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;}<br>
&nbsp;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Reconstruct&nbsp;world&nbsp;position<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;world_pos&nbsp;=&nbsp;reconstruct_world_pos(v_uv,&nbsp;linear_depth);<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;normal&nbsp;=&nbsp;texture(u_normal_texture,&nbsp;v_uv).rgb&nbsp;*&nbsp;2.0&nbsp;-&nbsp;1.0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;offseted_world_pos&nbsp;=&nbsp;world_pos&nbsp;+&nbsp;normal&nbsp;*&nbsp;0.01;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;fov_dir&nbsp;=&nbsp;normalize(world_pos&nbsp;-&nbsp;u_fov_camera_pos);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(normal&nbsp;*&nbsp;0.5&nbsp;+&nbsp;0.5,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(normal&nbsp;*&nbsp;0.5&nbsp;+&nbsp;0.5,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(fov_dir&nbsp;*&nbsp;0.5&nbsp;+&nbsp;0.5,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;}<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;dot_fov_normal&nbsp;=&nbsp;(-dot(fov_dir,&nbsp;normal)&nbsp;*&nbsp;0.5&nbsp;+&nbsp;0.5);<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(dot_fov_normal&nbsp;&lt;&nbsp;0.0)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Facing&nbsp;away&nbsp;from&nbsp;FOV&nbsp;camera,&nbsp;consider&nbsp;not&nbsp;visible<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(dot_fov_normal,&nbsp;dot_fov_normal,&nbsp;dot_fov_normal,&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;DEBUG<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;float&nbsp;debug_depth&nbsp;=&nbsp;fov_linear_depth_from_world_pos(world_pos)&nbsp;/&nbsp;u_fov_distance;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;FragColor&nbsp;=&nbsp;vec4(vec3(debug_depth),&nbsp;1.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;return;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;FOV&nbsp;visibility&nbsp;and&nbsp;tint&nbsp;green&nbsp;if&nbsp;visible<br>
<br>
<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(is_visible_from_fov(offseted_world_pos,&nbsp;u_depth_bias))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color.rgb&nbsp;=&nbsp;mix(color.rgb,&nbsp;vec3(0.0,&nbsp;1.0,&nbsp;0.0),&nbsp;0.3);<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;color;<br>
}<br>
@endstage<br>
<br>
@endphase<br>
<!-- END SCAT CODE -->
</body>
</html>
