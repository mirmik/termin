<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>examples/visual/ui_widget_demo.py</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
&quot;&quot;&quot;Demo&nbsp;of&nbsp;the&nbsp;widget-based&nbsp;UI&nbsp;system&nbsp;with&nbsp;UIComponent.&quot;&quot;&quot;<br>
<br>
from&nbsp;__future__&nbsp;import&nbsp;annotations<br>
<br>
import&nbsp;numpy&nbsp;as&nbsp;np<br>
<br>
from&nbsp;termin.geombase&nbsp;import&nbsp;Pose3<br>
from&nbsp;termin.mesh.mesh&nbsp;import&nbsp;CubeMesh<br>
from&nbsp;termin.visualization&nbsp;import&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;Entity,<br>
&nbsp;&nbsp;&nbsp;&nbsp;MeshDrawable,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Scene,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Material,<br>
&nbsp;&nbsp;&nbsp;&nbsp;VisualizationWorld,<br>
&nbsp;&nbsp;&nbsp;&nbsp;PerspectiveCameraComponent,<br>
&nbsp;&nbsp;&nbsp;&nbsp;OrbitCameraController,<br>
)<br>
from&nbsp;termin.visualization.render.components&nbsp;import&nbsp;MeshRenderer<br>
from&nbsp;termin._native.render&nbsp;import&nbsp;TcShader<br>
from&nbsp;termin.visualization.ui.widgets&nbsp;import&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;UIComponent,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Panel,<br>
&nbsp;&nbsp;&nbsp;&nbsp;VStack,<br>
&nbsp;&nbsp;&nbsp;&nbsp;HStack,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Label,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Button,<br>
&nbsp;&nbsp;&nbsp;&nbsp;Separator,<br>
&nbsp;&nbsp;&nbsp;&nbsp;px,<br>
&nbsp;&nbsp;&nbsp;&nbsp;pct,<br>
)<br>
from&nbsp;termin.visualization.ui.font&nbsp;import&nbsp;FontTextureAtlas<br>
<br>
<br>
#&nbsp;3D&nbsp;shader<br>
VERT&nbsp;=&nbsp;&quot;&quot;&quot;<br>
#version&nbsp;330&nbsp;core<br>
layout(location&nbsp;=&nbsp;0)&nbsp;in&nbsp;vec3&nbsp;a_position;<br>
layout(location&nbsp;=&nbsp;1)&nbsp;in&nbsp;vec3&nbsp;a_normal;<br>
<br>
uniform&nbsp;mat4&nbsp;u_model;<br>
uniform&nbsp;mat4&nbsp;u_view;<br>
uniform&nbsp;mat4&nbsp;u_projection;<br>
<br>
out&nbsp;vec3&nbsp;v_normal;<br>
<br>
void&nbsp;main()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;v_normal&nbsp;=&nbsp;mat3(transpose(inverse(u_model)))&nbsp;*&nbsp;a_normal;<br>
&nbsp;&nbsp;&nbsp;&nbsp;gl_Position&nbsp;=&nbsp;u_projection&nbsp;*&nbsp;u_view&nbsp;*&nbsp;u_model&nbsp;*&nbsp;vec4(a_position,&nbsp;1.0);<br>
}<br>
&quot;&quot;&quot;<br>
<br>
FRAG&nbsp;=&nbsp;&quot;&quot;&quot;<br>
#version&nbsp;330&nbsp;core<br>
in&nbsp;vec3&nbsp;v_normal;<br>
uniform&nbsp;vec4&nbsp;u_color;<br>
uniform&nbsp;vec3&nbsp;u_light_dir;<br>
out&nbsp;vec4&nbsp;FragColor;<br>
<br>
void&nbsp;main(){<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;N&nbsp;=&nbsp;normalize(v_normal);<br>
&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;ndotl&nbsp;=&nbsp;max(dot(N,&nbsp;-normalize(u_light_dir)),&nbsp;0.0);<br>
&nbsp;&nbsp;&nbsp;&nbsp;vec3&nbsp;color&nbsp;=&nbsp;u_color.rgb&nbsp;*&nbsp;(0.2&nbsp;+&nbsp;0.8&nbsp;*&nbsp;ndotl);<br>
&nbsp;&nbsp;&nbsp;&nbsp;FragColor&nbsp;=&nbsp;vec4(color,&nbsp;u_color.a);<br>
}<br>
&quot;&quot;&quot;<br>
<br>
<br>
def&nbsp;build_scene(world:&nbsp;VisualizationWorld):<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;3D&nbsp;cube<br>
&nbsp;&nbsp;&nbsp;&nbsp;shader&nbsp;=&nbsp;TcShader.from_sources(VERT,&nbsp;FRAG,&nbsp;&quot;&quot;,&nbsp;&quot;UIWidgetDemoShader&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;material&nbsp;=&nbsp;Material(shader=shader,&nbsp;color=np.array([0.6,&nbsp;0.8,&nbsp;0.9,&nbsp;1.0],&nbsp;dtype=np.float32))<br>
&nbsp;&nbsp;&nbsp;&nbsp;cube_mesh&nbsp;=&nbsp;MeshDrawable(CubeMesh(size=1.0))<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;cube&nbsp;=&nbsp;Entity(name=&quot;cube&quot;,&nbsp;pose=Pose3.identity())<br>
&nbsp;&nbsp;&nbsp;&nbsp;cube.add_component(MeshRenderer(cube_mesh,&nbsp;material))<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene&nbsp;=&nbsp;Scene()<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(cube)<br>
&nbsp;&nbsp;&nbsp;&nbsp;world.add_scene(scene)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Camera&nbsp;+&nbsp;orbit&nbsp;controller<br>
&nbsp;&nbsp;&nbsp;&nbsp;cam_entity&nbsp;=&nbsp;Entity(name=&quot;camera&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;cam&nbsp;=&nbsp;PerspectiveCameraComponent()<br>
&nbsp;&nbsp;&nbsp;&nbsp;cam_entity.add_component(cam)<br>
&nbsp;&nbsp;&nbsp;&nbsp;cam_entity.add_component(OrbitCameraController(radius=5.0))<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(cam_entity)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;---&nbsp;UI&nbsp;via&nbsp;UIComponent&nbsp;---<br>
&nbsp;&nbsp;&nbsp;&nbsp;ui_entity&nbsp;=&nbsp;Entity(name=&quot;ui&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;ui_comp&nbsp;=&nbsp;UIComponent(priority=0)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Load&nbsp;font<br>
&nbsp;&nbsp;&nbsp;&nbsp;ui_comp.font&nbsp;=&nbsp;FontTextureAtlas(&quot;examples/data/fonts/Roboto-Regular.ttf&quot;,&nbsp;size=32)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Build&nbsp;UI&nbsp;programmatically<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel&nbsp;=&nbsp;Panel()<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel.name&nbsp;=&nbsp;&quot;main_panel&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel.padding&nbsp;=&nbsp;15<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel.background_color&nbsp;=&nbsp;(0.1,&nbsp;0.1,&nbsp;0.15,&nbsp;0.9)<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel.border_radius&nbsp;=&nbsp;8<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel.preferred_width&nbsp;=&nbsp;px(250)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack&nbsp;=&nbsp;VStack()<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack.spacing&nbsp;=&nbsp;10<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack.alignment&nbsp;=&nbsp;&quot;left&quot;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Title<br>
&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;=&nbsp;Label()<br>
&nbsp;&nbsp;&nbsp;&nbsp;title.text&nbsp;=&nbsp;&quot;Widget&nbsp;UI&nbsp;Demo&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;title.font_size&nbsp;=&nbsp;20<br>
&nbsp;&nbsp;&nbsp;&nbsp;title.color&nbsp;=&nbsp;(1,&nbsp;1,&nbsp;1,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack.add_child(title)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Separator<br>
&nbsp;&nbsp;&nbsp;&nbsp;sep&nbsp;=&nbsp;Separator()<br>
&nbsp;&nbsp;&nbsp;&nbsp;sep.orientation&nbsp;=&nbsp;&quot;horizontal&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;sep.color&nbsp;=&nbsp;(0.5,&nbsp;0.5,&nbsp;0.5,&nbsp;0.5)<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack.add_child(sep)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Info&nbsp;label<br>
&nbsp;&nbsp;&nbsp;&nbsp;info&nbsp;=&nbsp;Label()<br>
&nbsp;&nbsp;&nbsp;&nbsp;info.name&nbsp;=&nbsp;&quot;info_label&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;info.text&nbsp;=&nbsp;&quot;Click&nbsp;count:&nbsp;0&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;info.font_size&nbsp;=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;info.color&nbsp;=&nbsp;(0.8,&nbsp;0.8,&nbsp;0.8,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack.add_child(info)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Button&nbsp;row<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn_row&nbsp;=&nbsp;HStack()<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn_row.spacing&nbsp;=&nbsp;10<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;click_count&nbsp;=&nbsp;[0]<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;on_click():<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;click_count[0]&nbsp;+=&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info.text&nbsp;=&nbsp;f&quot;Click&nbsp;count:&nbsp;{click_count[0]}&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f&quot;Button&nbsp;clicked!&nbsp;Count:&nbsp;{click_count[0]}&quot;)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn&nbsp;=&nbsp;Button()<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.name&nbsp;=&nbsp;&quot;click_button&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.text&nbsp;=&nbsp;&quot;Click&nbsp;me!&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.font_size&nbsp;=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.padding&nbsp;=&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.background_color&nbsp;=&nbsp;(0.2,&nbsp;0.5,&nbsp;0.8,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.hover_color&nbsp;=&nbsp;(0.3,&nbsp;0.6,&nbsp;0.9,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.pressed_color&nbsp;=&nbsp;(0.1,&nbsp;0.4,&nbsp;0.7,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn.on_click&nbsp;=&nbsp;on_click<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn_row.add_child(btn)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn&nbsp;=&nbsp;Button()<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.text&nbsp;=&nbsp;&quot;Reset&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.font_size&nbsp;=&nbsp;14<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.padding&nbsp;=&nbsp;12<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.background_color&nbsp;=&nbsp;(0.5,&nbsp;0.2,&nbsp;0.2,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.hover_color&nbsp;=&nbsp;(0.6,&nbsp;0.3,&nbsp;0.3,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.pressed_color&nbsp;=&nbsp;(0.4,&nbsp;0.1,&nbsp;0.1,&nbsp;1)<br>
&nbsp;&nbsp;&nbsp;&nbsp;reset_btn.on_click&nbsp;=&nbsp;lambda:&nbsp;(click_count.__setitem__(0,&nbsp;0),&nbsp;info.__setattr__(&quot;text&quot;,&nbsp;&quot;Click&nbsp;count:&nbsp;0&quot;))<br>
&nbsp;&nbsp;&nbsp;&nbsp;btn_row.add_child(reset_btn)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;stack.add_child(btn_row)<br>
&nbsp;&nbsp;&nbsp;&nbsp;panel.add_child(stack)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;ui_comp.root&nbsp;=&nbsp;panel<br>
&nbsp;&nbsp;&nbsp;&nbsp;ui_entity.add_component(ui_comp)<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene.add(ui_entity)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;scene,&nbsp;cam<br>
<br>
<br>
def&nbsp;main():<br>
&nbsp;&nbsp;&nbsp;&nbsp;world&nbsp;=&nbsp;VisualizationWorld()<br>
&nbsp;&nbsp;&nbsp;&nbsp;scene,&nbsp;cam&nbsp;=&nbsp;build_scene(world)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;win&nbsp;=&nbsp;world.create_window(title=&quot;Widget&nbsp;UI&nbsp;Demo&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;win.add_viewport(scene,&nbsp;cam)<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;world.run()<br>
<br>
<br>
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;main()<br>
<!-- END SCAT CODE -->
</body>
</html>
